# K-Fold Cross Validation Configuration for Cut Selection Model
# Based on config_cut_selection.yaml

# K-Fold settings
n_folds: 5  # Number of folds (5 is standard)
random_state: 42  # For reproducible splits

# Data path (combined train + val data)
data_path: preprocessed_data/combined_sequences_cut_selection.npz

# Feature dimensions
audio_features: 215
visual_features: 522

# Model architecture
d_model: 256
nhead: 8
num_encoder_layers: 6
dim_feedforward: 1024
dropout: 0.15
fusion_type: gated

# Training hyperparameters
batch_size: 16
num_epochs: 50
learning_rate: 0.0001
weight_decay: 0.0001

# Loss settings
use_focal_loss: true  # Focal Lossを有効化（不均衡データに特化）
focal_alpha: 0.75  # 採用クラスの重み（0.75 = 採用を重視）
focal_gamma: 3.0  # 難しいサンプルへの集中度（大きいほど難しいサンプルに集中）
tv_weight: 0.05
label_smoothing: 0.0

# Checkpointing
checkpoint_dir: checkpoints_cut_selection_kfold
early_stopping_patience: 10  # Reduced for K-Fold (each fold trains faster)

# Data loading
num_workers: 0

# Device
cpu: false
use_amp: true
